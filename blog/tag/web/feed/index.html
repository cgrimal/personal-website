<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0"
	xmlns:content="http://purl.org/rss/1.0/modules/content/"
	xmlns:wfw="http://wellformedweb.org/CommentAPI/"
	xmlns:dc="http://purl.org/dc/elements/1.1/"
	xmlns:atom="http://www.w3.org/2005/Atom"
	xmlns:sy="http://purl.org/rss/1.0/modules/syndication/"
	xmlns:slash="http://purl.org/rss/1.0/modules/slash/"
	>

<channel>
	<title>Les notes de Clément &#187; web</title>
	<atom:link href="http://clementgrimal.fr/blog/tag/web/feed/" rel="self" type="application/rss+xml" />
	<link>http://clementgrimal.fr/blog</link>
	<description>Spécialiste de rien // Partageur de tout</description>
	<lastBuildDate>Tue, 24 Dec 2013 00:29:30 +0000</lastBuildDate>
	<language>fr-FR</language>
		<sy:updatePeriod>hourly</sy:updatePeriod>
		<sy:updateFrequency>1</sy:updateFrequency>
	<generator>https://wordpress.org/?v=3.8.41</generator>
	<item>
		<title>Projet &#171;&#160;Sur les épaules de Darwin&#160;&#187;</title>
		<link>http://clementgrimal.fr/blog/2013/03/21/projet-sur-les-epaules-de-darwin/</link>
		<comments>http://clementgrimal.fr/blog/2013/03/21/projet-sur-les-epaules-de-darwin/#comments</comments>
		<pubDate>Thu, 21 Mar 2013 18:30:27 +0000</pubDate>
		<dc:creator><![CDATA[Clément]]></dc:creator>
				<category><![CDATA[Non classé]]></category>
		<category><![CDATA[darwin]]></category>
		<category><![CDATA[git]]></category>
		<category><![CDATA[python]]></category>
		<category><![CDATA[web]]></category>

		<guid isPermaLink="false">http://clementgrimal.fr/blog/?p=477</guid>
		<description><![CDATA[J&#8217;ai déjà parlé de cette superbe émission dans un précédent article, Sur les épaules de Darwin, de Jean-Claude Ameisen, et je ne le referai donc pas ici. J&#8217;avais également parlé de la page que j&#8217;ai créé pour suivre cette émission, et surtout pourvoir ré-écouter ou télécharger des épisodes : http://www.clementgrimal.fr/darwin/. Mais surtout, j&#8217;avais promis de partager la [&#8230;]]]></description>
				<content:encoded><![CDATA[<p>J&rsquo;ai déjà parlé de cette superbe émission dans un précédent article, <a title="Sur les épaules de Darwin" href="http://clementgrimal.fr/blog/2013/01/17/sur-les-epaules-de-darwin/">Sur les épaules de Darwin, de Jean-Claude Ameisen</a>, et je ne le referai donc pas ici. J&rsquo;avais également parlé de la page que j&rsquo;ai créé pour suivre cette émission, et surtout pourvoir ré-écouter ou télécharger des épisodes : <a title="http://www.clementgrimal.fr/darwin/" href="http://www.clementgrimal.fr/darwin/" target="_blank">http://www.clementgrimal.fr/darwin/</a>. Mais surtout, j&rsquo;avais promis de partager la recette qui se cache derrière cette page !</p>
<p>Pour créer cette page, j&rsquo;utilise plusieurs scripts écrits en Python, qui utilisent eux-mêmes un fichier base de données pour stocker toutes les informations sur les épisodes (titre, date de diffusion, &#8230;). Afin de facilement les partager avec tout le monde, j&rsquo;ai donc créé un projet sur le site GitHub : <a href="https://github.com/cgrimal/darwin">https://github.com/cgrimal/darwin</a>. Maintenant, rien ne vous empêche de récupérer intégralement ces scripts, pour vous même créer une page web autour de l&rsquo;émission (merci de me prévenir quand même, ça me fera plaisir !), et même de télécharger les épisodes en mp3.</p>
<p>Non seulement je pense que c&rsquo;est une bonne chose de partager ce genre de projet car je ne compte pas faire de l&rsquo;argent avec, mais en plus, cela m&rsquo;a permis de m&rsquo;initier à git, qui est un système de gestion de version bien pratique !</p>
<h3>Comment télécharger les fichiers mp3 de l&rsquo;émission ?</h3>
<p>En fait, je pense que beaucoup de gens se posent la question, et si vous êtes dans ce cas, je pense modestement pouvoir vous aider. Cependant, pour mieux répondre, il me faut vous poser la question suivante : êtes-vous un informaticien/geek/python-gourou ?</p>
<ul>
<li><strong>Si oui</strong>, vous n&rsquo;avez surement pas besoin de moi, mais si vous ne voulez pas ré-inventer la roue, servez-vous de mon code : darwin_create_database.py pour récupérer les informations (dont les liens directs vers les fichiers mp3), puis darwin_download.py pour télécharger les fichiers.</li>
<li><strong>Sinon</strong>, vous pouvez cliquer sur les liens &laquo;&nbsp;Télécharger&nbsp;&raquo; pour télécharger les émissions une par une, ou alors me demander dans <a href="#reply-title">les commentaires</a> ou directement par mail (<a title="Envoyez-moi un mail !" href="mailto:clement.grimal@gmail.com" target="_blank">clement.grimal@gmail.com</a>) de l&rsquo;aide !</li>
</ul>]]></content:encoded>
			<wfw:commentRss>http://clementgrimal.fr/blog/2013/03/21/projet-sur-les-epaules-de-darwin/feed/</wfw:commentRss>
		<slash:comments>9</slash:comments>
		</item>
		<item>
		<title>Raspberry Pi : installation d&#8217;un serveur web</title>
		<link>http://clementgrimal.fr/blog/2013/01/24/raspberry-pi-serveur-web-sfr-box/</link>
		<comments>http://clementgrimal.fr/blog/2013/01/24/raspberry-pi-serveur-web-sfr-box/#comments</comments>
		<pubDate>Thu, 24 Jan 2013 18:01:01 +0000</pubDate>
		<dc:creator><![CDATA[Clément]]></dc:creator>
				<category><![CDATA[Non classé]]></category>
		<category><![CDATA[administration]]></category>
		<category><![CDATA[raspberry-pi]]></category>
		<category><![CDATA[tutoriel]]></category>
		<category><![CDATA[unix]]></category>
		<category><![CDATA[web]]></category>

		<guid isPermaLink="false">http://clementgrimal.fr/blog/?p=222</guid>
		<description><![CDATA[Dans ce billet, je vais décrire comment j&#8217;ai installé un serveur web sur mon Raspberry Pi, mais surtout comment j&#8217;ai configuré mon installation sachant que mon fournisseur d&#8217;accès est SFR. Dans la première moitié, je décris l&#8217;installation du serveur et la configuration minimale pour tester. Et dans la seconde partie, je décris comment s&#8217;en sortir [&#8230;]]]></description>
				<content:encoded><![CDATA[<p>Dans ce billet, je vais décrire comment j&rsquo;ai installé un serveur web sur mon Raspberry Pi, mais surtout comment j&rsquo;ai configuré mon installation sachant que mon fournisseur d&rsquo;accès est SFR.</p>
<p>Dans la première moitié, je décris l&rsquo;installation du serveur et la configuration minimale pour tester. Et dans la seconde partie, je décris comment s&rsquo;en sortir sans adresse IP fixe (comme c&rsquo;est le cas chez SFR).</p>
<p><strong>MODIFICATION : </strong>j&rsquo;ai finalement réussi à utilisé un service de DNS dynamique, qui me permet de ne pas forcément utiliser mon script compliqué : <a title="Utilisation d’un DNS dynamique" href="http://clementgrimal.fr/blog/2013/01/29/utilisation-dns-dynamique/">voir ce billet</a> ! </p>
<h3 style="clear: both;">Installation du serveur et configuration minimale</h3>
<h4>Installation du serveur</h4>
<p>On va installer un serveur web, communément appelé <a href="https://fr.wikipedia.org/wiki/LAMP" target="_blak">LAMP</a>, pour Linux / Apache / MySQL / PHP. Avec ça vous aurez de quoi faire tourner un petit site web, avec base de données et pages dynamiques. Il suffit d&rsquo;installer les paquets suivants :</p>
<pre class="brush:bash">	sudo apt-get install apache2 php5 mysql-server libapache2-mod-php5 php5-mysql
</pre>
<p>La racine de votre site se situe alors dans le dossier <code>/var/www/</code> et si vous allez sur la page <a href="http://localhost:80" target="_blank">localhost:80</a>, vous devriez voir la page par défaut d&rsquo;Apache qui dit &laquo;&nbsp;It Works!&nbsp;&raquo;.</p>
<h4>Trouver son adresse IP externe</h4>
<p>Il y a plusieurs façon de faire : vous pouvez vous rendre sur l&rsquo;interface de votre box <a href="http://192.168.1.1" target="_blank">192.168.1.1</a> et l&rsquo;adresse IP est alors visible en haut à droite. Vous pouvez également utiliser un site web tel que <a href="http://www.ipogre.com" target="_blank">ipogre.com</a> (nous l&rsquo;utiliserons d&rsquo;ailleurs dans la seconde partie).</p>
<p>Mais si vous donner cette adresse IP à quelqu&rsquo;un pour qu&rsquo;il puisse voir le site web hebergé sur votre Raspberry, cela ne marchera pas car il &laquo;&nbsp;atterrira&nbsp;&raquo; sur la box ! On va donc voir comment la paramétrer dans la suite.</p>
<h4>Paramètrer sa box</h4>
<p>Par défaut, lorsqu&rsquo;un nouvel équipement se connecte à la box (wifi ou ethernet), elle lui attribue une adresse IP locale aléatoire du type <code>192.168.1.XX</code>. Pour que le Raspberry soit toujours à la même adresse (ce sera mieux pour le retrouver), on va demander à la box de lui attribuer une IP locale fixe. Il faut aller sur l&rsquo;interface de la box (<a href="http://localhost:80" target="_blank">localhost:80</a>), dans l&rsquo;onglet DHCP de la section Réseau. Regarder l&rsquo;aide de SFR à ce sujet qui est très bien faire : <a href="http://assistance.sfr.fr/internet_box-nb4/connexion/hebergement-site-web-box/fc-462-73201" target="_blank">Héberger son site web à la maison avec sa box</a>.</p>
<p>Maintenant, il faut rediriger le port 80 (celui du serveur web) vers votre Raspberry. C&rsquo;est aussi expliqué sur la page d&rsquo;aide de SFR, et il suffit d&rsquo;ajouter une règle NAT. D&rsquo;ailleurs, vous pouvez en profiter pour ajouter d&rsquo;autres règles. En redirigeant également le port 22, vous pourrez vous connecter en ssh à votre Raspberry depuis n&rsquo;importe où !</p>
<h4>Test</h4>
<p>Vous pouvez maintenant donner votre adresse IP externe à votre fameux ami qui meurt d&rsquo;envie de voir le site web que vous hébergez sur votre Raspberry. Disons que cette adresse est <code>A.B.C.D</code>, s&rsquo;il se rend à l&rsquo;adresse <a href="#">A.B.C.D</a> sur son navigateur, il atterrira sur votre site ! Si vous testez de chez vous, vous arriverez sur l&rsquo;interface de la box, ce qui est moins intéressant, utilisez l&rsquo;adresse IP locale de votre raspberry.</p>
<p>&nbsp;</p>
<h3>Script pour ne pas utiliser DynDNS</h3>
<p>Chez SFR, l&rsquo;adresse IP de votre box change régulièrement, et il est possible de souscrire à un service de DNS dynamique pour que l&rsquo;adresse <a href="javascript:void(0)">mon-rpi.dyndns.fr</a> redirige toujours vers votre box. Seulement je n&rsquo;ai pas réussi ! Il faut normalement aller dans l&rsquo;onglet DynDNS de la section Réseau de l&rsquo;interface de la box, mais le dervide dyndns.fr n&rsquo;est pas présent, et donc j&rsquo;ai préféré m&rsquo;en passer pour l&rsquo;instant.</p>
<p>Pour ne pas être bloqué, on m&rsquo;a soufflé l&rsquo;idée suivante : faire un script qui vérifie si l&rsquo;adresse IP a changée, si oui le script doit m&rsquo;envoyer un mail avec la nouvelle adresse IP. Puis il suffit de faire s&rsquo;exécuter ce script automatiquement à intervalles réguliers.</p>
<h4>Le script</h4>
<p>On va mettre le script dans le répertoire <code>/usr/local/bin/ipcheck.sh</code> :</p>
<pre class="brush:bash">#!/bin/bash
IPFILE=/etc/ipaddress

CURRENT_IP=$(curl ipogre.com)

MAIL_TO=votre_adresse@domaine.fr

if [ -f $IPFILE ]; then
	KNOWN_IP=$(cat $IPFILE)
	else
	KNOWN_IP=
fi

if [ "$CURRENT_IP" != "$KNOWN_IP" ]; then
	echo $CURRENT_IP &gt; $IPFILE

	MAIL_SUBJECT="L'adresse IP du RPI a changé !"
	MAIL_BODY="C'est maintenant $CURRENT_IP"

	echo $MAIL_BODY | mail -s "$MAIL_SUBJECT" $MAIL_TO
	logger -t ipcheck -- Nouvelle adresse IP : $CURRENT_IP
else
	logger -t ipcheck -- Même adresse IP.
fi
</pre>
<p>Donc l&rsquo;adresse IP va être stockée dans le fichier <code>/etc/ipaddress</code> et on utilise le site <a href="http://www.ipogre.com" target="_blank">ipogre.com</a> pour récupérer l&rsquo;adresse externe. Puis on compare l&rsquo;ancienne adresse avec la courante, et si ce n&rsquo;est pas la même, on envoie le mail. Voyons maintenant ce qu&rsquo;il faut installer et configurer pour que tout marche bien.</p>
<h4>Installation curl</h4>
<p>Je ne sais plus s&rsquo;il est installé de base dans Raspbian, dans le doute :</p>
<pre class="brush:bash">	sudo apt-get install curl
</pre>
<h4>Envoi de mail</h4>
<p>La partie qui risque de poser problème concerne l&rsquo;envoi de mail. Car la commande <code>mail</code> ne fait qu&rsquo;appeler le <a title="Définition de MTA" href="https://fr.wikipedia.org/wiki/Mail_Transfer_Agent" target="_blank">MTA</a> installé localement. J&rsquo;ai opté pour <a title="Page du paquet Debian" href="http://wiki.debian.org/sSMTP" target="_blank"><code>ssmtp</code></a> qui est très simple à installer et configurer :</p>
<pre class="brush:bash">sudo apt-get install ssmtp
</pre>
<p>Je l&rsquo;ai configurer pour utilisé mon compte Gmail pour les envois. Il faut alors éditer le fichier <code>/etc/ssmtp/ssmtp.conf</code> pour modifier les lignes suivantes :</p>
<pre class="brush:plain">mailhub=smtp.gmail.com:587
UseTLS=Yes
UseSTARTTLS=Yes
AuthUser=votre_login_gmail
AuthPass=votre_mot_de_passe_gmail
</pre>
<p><strong>Attention</strong>, votre mot de passe Gmail n&rsquo;est pas crypté, il faut donc s&rsquo;assurer que le fichier ne sera pas lisible par n&rsquo;importe qui ! :</p>
<pre class="brush:bash">sudo chmod 640 /etc/ssmtp/ssmtp.conf
sudo chown root:mail /etc/ssmtp/ssmtp.conf
</pre>
<h4>Cron du script</h4>
<p>On va &laquo;&nbsp;croner&nbsp;&raquo; ce script pour qu&rsquo;il s&rsquo;exécute automatiquement toutes les heures. Comme il n&rsquo;y a que l&rsquo;utilisateur <code>root</code> (cf. le <code>chown</code> à l&rsquo;étape précédente), il faut ajouter la tâche en sudo :</p>
<pre class="brush:bash">	sudo crontab -e
</pre>
<p>Et ajouter la ligne suivante :</p>
<pre class="brush:bash">0 * * * * /usr/local/bin/ipcheck.sh &gt;/dev/null 2&gt;&amp;1
</pre>
<p>Voilà ! Maintenant, toutes les heures, votre RPi vérifiera que son adresse IP externe n&rsquo;a pas changée. Si elle a en effet changée, il vous enverra un e-mail pour vous donner la nouvelle adresse. Vous pourrez également voir le log dans le fichier <code>/var/log/user.log</code>, en utilisant la commande <code>tail</code> par exemple.</p>
<h3>Conclusion</h3>
<p>Bien sûr, le gros problème avec cette solution (sans DNS dynamique), est qu&rsquo;il vous faudra prévenir vos amis à chaque changement d&rsquo;adresse IP ! Ce n&rsquo;est bien sûr pas une solution viable pour un vrai site (mais fait uniquement pour partager avec des amis), et il faudra alors songer à acheter un vrai nom de domaine, associé à une solution de DNS dynamique.</p>
<div>
<p class="beforelist"><strong>Sources (en anglais&#8230;) :</strong></p>
<ul>
<li><a href="http://www.penguintutor.com/linux/raspberrypi-webserver" target="_blank">Installation serveur web sur Raspberry Pi</a></li>
<li><a href="http://ubuntuforums.org/archive/index.php/t-526176.html" target="_blank">Récupérer son adresse IP externe depuis le terminal, et script pour l&rsquo;envoi d&rsquo;un mail si modifiée</a></li>
<li><a href="http://assistance.sfr.fr/internet_box-nb4/connexion/hebergement-site-web-box/fc-462-73201" target="_blank">Serveur web derrière box SFR</a></li>
<li><a href="http://assistance.sfr.fr/internet_box-nb4/emails-avec-sfr/desactiver-filtrage-smtp/fc-2491-69602" target="_blank">Autoriser l&rsquo;envoi de mail derrière votre box SFR</a></li>
<li><a href="http://stackoverflow.com/questions/9168432/unix-standard-directory-to-put-custom-executables-or-scripts" target="_blank">Où placer ces exécutables perso ?</a></li>
</ul>
</div>
<p>N&rsquo;hésitez pas à me faire part de toute remarques / corrections / erreurs !</p>]]></content:encoded>
			<wfw:commentRss>http://clementgrimal.fr/blog/2013/01/24/raspberry-pi-serveur-web-sfr-box/feed/</wfw:commentRss>
		<slash:comments>6</slash:comments>
		</item>
	</channel>
</rss>
